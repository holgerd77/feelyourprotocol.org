import{_ as T,a as $,b as D,d as L,e as x,f as N,i as I,v as O,r as W,H as P,h as X}from"./precompiles-CRrTAYhO.js";import{d as Y,E as J,r as o,u as M,a as z,b as G,c as K,o as S,e as q,f as C,g as a,j as Q,h as d,k as Z,F as ee,i as f}from"./index-C7w1sOAK.js";const ae={class:"text-right"},te={class:"grid grid-cols-2 gap-1 mt-2.5"},oe=Y({__name:"EIP7951C",async setup(le){let g,y;const w=J["eip-7951"],r=o(""),e=o(Array(5).fill("")),i=o(Array(5).fill(void 0)),b=o([32n,32n,32n,32n,32n]),p=o(Array(5).fill(0n)),n=o(""),v=o(),m=o(),F=o([{name:"Noble Curves",href:"https://github.com/paulmillr/noble-curves"},{name:"EthereumJS",href:"https://github.com/ethereumjs/ethereumjs-monorepo"}]),B=M(),c=z(),_={valid:{title:'Valid ("Hello Fusaka!")',values:["4dfb1eae8ed41e188b8a44a1109d982d01fc24bb85a933e6283e8838e46942fd","eb3dc5ce2902f162745057efb7a3308eba992c0d843623603516845ffccd3f10","3b91fedfb22f40063245c621036a040c159f02ae02e6d450ff9b53235e9232c4","bfa6d0a419b5bc625939cccb8db65a16f7c30c697928660e9da53eda031e80fa","db5998a893f9b8971a3892aecd132c0eca1bc9622e542f428d8129222f26bdc5"]},"invalid-sig-r":{title:'Invalid ("Hello Fusaka!"), modified sigR value',values:["4dfb1eae8ed41e188b8a44a1109d982d01fc24bb85a933e6283e8838e46942fd","ee3dc5ce2902f162745057efb7a3308eba992c0d843623603516845ffccd3f10","3b91fedfb22f40063245c621036a040c159f02ae02e6d450ff9b53235e9232c4","bfa6d0a419b5bc625939cccb8db65a16f7c30c697928660e9da53eda031e80fa","db5998a893f9b8971a3892aecd132c0eca1bc9622e542f428d8129222f26bdc5"]},"invalid-sig-0":{title:'Invalid ("Hello Fusaka!"), sigR and sigS values 0',values:["4dfb1eae8ed41e188b8a44a1109d982d01fc24bb85a933e6283e8838e46942fd","0000000000000000000000000000000000000000000000000000000000000000","0000000000000000000000000000000000000000000000000000000000000000","bfa6d0a419b5bc625939cccb8db65a16f7c30c697928660e9da53eda031e80fa","db5998a893f9b8971a3892aecd132c0eca1bc9622e542f428d8129222f26bdc5"]},"valid-wycheproof-special-case-hash":{title:"Valid (Wycheproof), special case hash",values:["00000000690ed426ccf17803ebe2bd0884bcd58a1bb5e7477ead3645f356e7a9","16aea964a2f6506d6f78c81c91fc7e8bded7d397738448de1e19a0ec580bf266","252cd762130c6667cfe8b7bc47d27d78391e8e80c578d1cd38c3ff033be928e9","2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838","c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e"]},"invalid-wycheproof-r-too-large":{title:"Invalid (Wycheproof), r value too large",values:["532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25","ffffffff00000001000000000000000000000000fffffffffffffffffffffffc","ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254e","d705d16f80987e2d9b1a6957d29ce22febf7d10fa515153182415c8361baaca4","b1fc105ee5ce80d514ec1238beae2037a6f83625593620d460819e8682160926"]}},V=async()=>{if(n.value!==""){for(let t=0;t<e.value.length;t++)e.value[t]=_[n.value].values[t];await h()}};function R(){const t=B.resolve({name:"eip-7951",query:{hash:e.value[0],sigr:e.value[1],sigs:e.value[2],pubx:e.value[3],puby:e.value[4]}});window.open(t.href,"_blank")}async function k(){await W(r.value,P.Prague,P.Osaka,"100",v,m)}async function U(){if(!I(r.value))return!1;X(r,e,i,p),await k()}async function A(){n.value="",await U()}async function h(){for(let t=0;t<e.value.length;t++)if(I(e.value[t],b.value[t]).length>0)return!1;O(e,i,b,p),r.value=e.value.join(""),await k()}async function E(){n.value="",await h()}async function H(){if("b"in c.query&&"e"in c.query&&"m"in c.query)try{e.value[0]=c.query.hash.toString(),e.value[1]=c.query.sigr.toString(),e.value[2]=c.query.sigs.toString(),e.value[3]=c.query.pubx.toString(),e.value[4]=c.query.puby.toString(),await h()}catch{console.log("Invalid parameter call!")}else n.value="valid",await V()}return[g,y]=G(()=>H()),await g,y(),(t,l)=>(S(),K(T,{title:q(w).title,eip:q(w).num,shareURL:R},{description:C(()=>[...l[4]||(l[4]=[a("p",null,[a("b",null,"How can I interact with the new curve precompile?"),f(" The "),a("a",{href:"https://www.nervos.org/knowledge-base/what_is_secp256r1",target:"_blank"},"secp256r1"),f(" (also know as P-256) precompile improves Ethereum's UX by allowing efficient in-contract-signature verification (e.g. for multisig wallets) from "),a("a",{href:"https://developer.apple.com/documentation/cryptokit/p256",target:"_blank"},"Apple"),f(" and "),a("a",{href:"https://developer.android.com/privacy-and-security/keystore",target:"_blank"},"Android"),f(" devices as well as "),a("a",{href:"https://webauthn.io/",target:"_blank"},"FIDO2/WebAuthn"),f(" supporting browsers. ")],-1),a("p",{class:"mt-4"},[f(" The interface below lets you explore how to directly interact with the precompile (at address "),a("code",null,"0x100"),f("). You can use libraries like "),a("a",{href:"https://github.com/paulmillr/noble-curves?tab=readme-ov-file#secp256k1-p256-p384-p521-ed25519-ed448-brainpool",target:"_blank"},"Noble Curves"),f(" to generate a valid signature to test - see "),a("a",{href:"https://github.com/ethereumjs/ethereumjs-monorepo/tree/master/packages/evm#eip-7951-precompile-for-secp256r1-curve-support-osaka",target:"_blank"},"here"),f(" for example code - or use one of the examples provided. The precompile will return "),a("code",null,"0x01"),f(" (as 32-bytes) if the signature is valid. ")],-1)])]),content:C(()=>[a("div",null,[a("p",ae,[d($,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=s=>n.value=s),examples:_,change:V},null,8,["modelValue"])]),a("p",null,[d(D,{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=s=>r.value=s),rows:"6",formChange:A},null,8,["modelValue"])]),(S(),Q(ee,null,Z(["Hash","SigR","SigS","PubX","PubY"],(s,u)=>d(L,{key:u,modelValue:e.value[u],"onUpdate:modelValue":j=>e.value[u]=j,title:s,input:E,len:p.value[u],expectedLen:b.value[u],bigIntVal:i.value[u]},null,8,["modelValue","onUpdate:modelValue","title","len","expectedLen","bigIntVal"])),64)),a("div",te,[d(x,{modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=s=>v.value=s),title:"Pre-Osaka",left:!0},null,8,["modelValue"]),d(x,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=s=>m.value=s),title:"Post-Osaka",left:!1},null,8,["modelValue"])]),d(N,{poweredBy:F.value},null,8,["poweredBy"])])]),_:1},8,["title","eip"]))}});export{oe as _};
